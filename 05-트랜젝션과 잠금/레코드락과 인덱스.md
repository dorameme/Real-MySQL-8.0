
레코드 락은 인덱스가 있는것에 한해서 인덱스로 찾은 레코드를 잠그고, 인덱스가 없을시엔 풀스캔한다.

### 1. 인덱스가 있는 경우

 레코드 락은 인덱스를 기준으로 걸림
 특정 조건을 만족하는 인덱스 엔트리를 찾아서 해당 행(row)만 잠금
 다른 행에는 영향이 거의 없음 → 높은 동시성 보장

예시:

```sql
SELECT  FROM orders WHERE id = 100 FOR UPDATE;
```

 `id`가 Primary Key라면, 클러스터형 인덱스에서 id=100 엔트리만 잠금

---

### 2. 인덱스가 없는 경우

 특정 행을 바로 찾을 기준이 없으므로 테이블 전체를 스캔(full table scan)
 조건에 맞는 행을 찾으면서 잠금을 걸어야 하기 때문에, 스캔된 모든 행을 확인하게 됨
 결과적으로 동시성 저하 발생, 갭 락/넥스트-키 락은 제한

예시:

```sql
SELECT  FROM orders WHERE user_id = 101 FOR UPDATE;
```

 `user_id`에 인덱스 없으면 모든 행을 순차 탐색하며 user\_id=101 확인 → 해당 행 잠금

---

### 3. 핵심 요약

| 상황     | 잠금 방식                | 특징                   |
| ------ | -------------------- | -------------------- |
| 인덱스 있음 | 인덱스로 특정 행 잠금         | 효율적, 동시성 높음          |
| 인덱스 없음 | 테이블 풀스캔 후 조건 만족 행 잠금 | 비효율적, 동시성 저하, 갭 락 제한 |

> 즉, 레코드 락은 인덱스를 기준으로 작동하도록 설계되어 있고, 인덱스 없으면 풀 테이블 스캔 방식으로 잠금을 걸게 된다.


